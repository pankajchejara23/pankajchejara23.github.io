<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.550">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Pankaj Chejara">
<meta name="dcterms.date" content="2021-06-22">

<title>Pankaj Chejara - Statistical tests in R</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Pankaj Chejara</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../blog.html"> 
<span class="menu-text">Blog</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../talks.html"> 
<span class="menu-text">Talks</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../publications.html"> 
<span class="menu-text">Publications</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../projects.html"> 
<span class="menu-text">Projects</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../awards.html"> 
<span class="menu-text">Awards</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/pankajchejara1"> <i class="bi bi-twitter" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/pankaj-chejara-5ab77855/"> <i class="bi bi-linkedin" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/pankajchejara23"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Statistical tests in R</h1>
                                <div class="quarto-categories">
                <div class="quarto-category">r</div>
                <div class="quarto-category">statistics</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Pankaj Chejara </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">June 22, 2021</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#why-we-do-the-statistical-test" id="toc-why-we-do-the-statistical-test" class="nav-link active" data-scroll-target="#why-we-do-the-statistical-test">Why we do the statistical test?</a></li>
  <li><a href="#how-to-do-it" id="toc-how-to-do-it" class="nav-link" data-scroll-target="#how-to-do-it">How to do it?</a></li>
  <li><a href="#when-to-do-which-test" id="toc-when-to-do-which-test" class="nav-link" data-scroll-target="#when-to-do-which-test">When to do which test?</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<p>This post delves into inferential statistics and explains two different statistical test. Additionally, this post also talks about the need of performing these tests along with their suitability based on available data.</p>
<p>In particular, this post tackles the following three questions.</p>
<ul>
<li>Why we do the statistical test?</li>
<li>How to do it?</li>
<li>When to do which test?</li>
</ul>
<section id="why-we-do-the-statistical-test" class="level3">
<h3 class="anchored" data-anchor-id="why-we-do-the-statistical-test">Why we do the statistical test?</h3>
<p>As we have already discussed that we often do not have access to the entire population. Instead, we have access to a small portion of the population known as a sample. We use this sample to infer knowledge about the population.</p>
<p>Following are a few examples to explain it further.</p>
<ul>
<li>We collected a sample of height data from students studying in university X. We computed the average of our sample and obtained the average height of students in our sample. Now we want to test whether the average height found in our sample is the same for the population.</li>
<li>We collected two samples from two universities’ students’ salaries. We want to see is there any difference between the average salary between two universities or not.</li>
<li>We collected two samples of test scores from the same classroom at the start of the semester and end of semester. We want to see students whether the students’ test scores’ were improved significantly or not.</li>
<li>We collected a salary sample of people working in Tallinn with their education levels (e.g., primary, secondary, bachelors, master, doctorate). We want to test is there any significant difference in salary among these various levels of education levels.</li>
</ul>
<p>All these aforementioned examples illustrate some of the cases where we can apply the statistical test to test our assumption or guess (aka. hypothesis). One thing to note here is we are not just interested in finding knowledge for our sample, we want to rather use it to gain knowledge about the population.</p>
<p><img src="./images/statistical_tests/intro.png" class="img-fluid"></p>
<p>The above diagram gives a pictorial representation of what we have just talked about. There are two classes- A and B. Let’s say there are 100 and 80 students in class A and B, respectively. We collected a sample of student’s test scores data from both classes. In our sample, we have test scores for only a few students (let’s say 35-40). We computed the average for both the samples and found that the sample-1 mean is higher than sample-2 mean. This is what we learned from our sample. Now, we want to see is it also the same for the population (classroom-A average is higher than classroom-B average test scores or not). Here comes the statistical test. We use them to infer knowledge about the population based on collected sample data.</p>
</section>
<section id="how-to-do-it" class="level3">
<h3 class="anchored" data-anchor-id="how-to-do-it">How to do it?</h3>
<p>We will cover one sample t-test, independent sample t-test, paired t-test, and ANOVA in R.</p>
<section id="independent-sample-t-test" class="level4">
<h4 class="anchored" data-anchor-id="independent-sample-t-test">Independent sample t-test</h4>
<p>We do this test when we have two independent samples and we want to compare a statistic for these two groups. For example, we want to compare the average salary of students working part-time from two different universities. In this case, we have two samples collected from different universities. These samples are independent because they contain data of different people.</p>
<p>Make sure the following assumption in your dataset when you do a t-test</p>
<ul>
<li>Continuous dependent variable.</li>
<li>Categorical independent variable for grouping.</li>
<li>Independent data samples</li>
<li>Dependent variable has a normal distribution.</li>
<li>Each group has the same variance.</li>
</ul>
<p>We will look at the above assumptions with the help of an example. Let’s say we have test scores from two classes: A and B. Now we want to test whether the difference between these two classes’ test scores is significant or not.</p>
<table class="table">
<thead>
<tr class="header">
<th>Class</th>
<th>TestScore</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td>99</td>
</tr>
<tr class="even">
<td>A</td>
<td>93</td>
</tr>
<tr class="odd">
<td>A</td>
<td>81</td>
</tr>
<tr class="even">
<td>A</td>
<td>92</td>
</tr>
<tr class="odd">
<td>A</td>
<td>89</td>
</tr>
<tr class="even">
<td>A</td>
<td>80</td>
</tr>
<tr class="odd">
<td>A</td>
<td>88</td>
</tr>
<tr class="even">
<td>A</td>
<td>81</td>
</tr>
<tr class="odd">
<td>A</td>
<td>100</td>
</tr>
<tr class="even">
<td>A</td>
<td>82</td>
</tr>
<tr class="odd">
<td>B</td>
<td>98</td>
</tr>
<tr class="even">
<td>B</td>
<td>66</td>
</tr>
<tr class="odd">
<td>B</td>
<td>86</td>
</tr>
<tr class="even">
<td>B</td>
<td>62</td>
</tr>
<tr class="odd">
<td>B</td>
<td>78</td>
</tr>
<tr class="even">
<td>B</td>
<td>87</td>
</tr>
<tr class="odd">
<td>B</td>
<td>77</td>
</tr>
<tr class="even">
<td>B</td>
<td>60</td>
</tr>
<tr class="odd">
<td>B</td>
<td>60</td>
</tr>
<tr class="even">
<td>B</td>
<td>79</td>
</tr>
</tbody>
</table>
<p>You can see the dataset has one continuous variable (TestScore: Numeric type) and one class variable as the grouping variable. This class variable tells the classroom from which the scores are collected.</p>
<p>Assumptions</p>
<ul>
<li><p>Continuous dependent variable: the dataset has continuous dependent variable (testScore).</p></li>
<li><p>Categorical independent variable: the dataset has a class variable which is a categorical variable(a variable that has categories of value).</p></li>
<li><p>The independence assumption can only ensure while data collection. We assume here that the data were collected independently.</p></li>
<li><p>Normal distribution: We can plot the test scores for each class and check for <code>bell shape</code>.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lattice)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rio)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># load dataset</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">import</span>(<span class="st">'data-file-name'</span>)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the distribution</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">densityplot</span>(<span class="sc">~</span> data<span class="sc">$</span>TestScore<span class="sc">|</span>data<span class="sc">$</span>Class)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><img src="./images/statistical_tests/normal.png" class="img-fluid"></p></li>
<li><p>Same variance in both groups (class A and B): We will compute the variance in both groups. We can use the dplyr package for computing variance class-wise.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>data <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(Class) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="fu">var</span>(TestScore))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>The variance for Class A and B are following</p>
<table class="table">
<thead>
<tr class="header">
<th>Class</th>
<th>Variance</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td>55.8</td>
</tr>
<tr class="even">
<td>B</td>
<td>169</td>
</tr>
</tbody>
</table>
<p>As we can see the variance is not the same and the difference is not small.</p>
<ul>
<li>If the variance is the same, we will use <a href="https://en.wikipedia.org/wiki/Student%27s_t-test"><strong>Student’s T-test</strong></a>.</li>
<li>If the variance is not the same then we will use <a href="https://en.wikipedia.org/wiki/Welch%27s_t-test"><strong>Welsh T-test</strong></a>.</li>
</ul>
<p>In our dataset, the variance is not the same therefore we will apply <strong>Welsh t-test</strong>.</p></li>
</ul>
<section id="performing-the-test" class="level5">
<h5 class="anchored" data-anchor-id="performing-the-test">Performing the test</h5>
<p>We will first set up our hypothesis. We want to test that is there any difference between the test scores of class <code>A</code> and <code>B</code>. We will follow the below steps</p>
<ol type="1">
<li>State Null and alternative hypothesis</li>
<li>Decide significance level <span class="math inline">\(\alpha\)</span></li>
<li>Perform test</li>
<li>Check the <code>p-value</code> and decide ‘whether to reject the null hypothesis or not’</li>
</ol>
<p>Now, let’s talk about each step in detail.</p>
<p>The <strong>first step</strong> is to formulate the <code>null</code> and <code>alternative</code> hypotheses. What are those? We specify what we want to test. For example, in our class’s test scores dataset, we want to test that the average test scores from two groups are different. It will become our <code>alternative</code> hypothesis. The null hypothesis is a hypothesis of no difference. In other words, the opposite of what we want to test. The below diagram is showing our null and alternative hypotheses.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./images/statistical_tests/hyp.png" class="img-fluid figure-img"></p>
<figcaption>hyp</figcaption>
</figure>
</div>
<p>The <strong>second step</strong> to decide the level of significance (<span class="math inline">\(\alpha\)</span>). You can choose one of the following: 1%, 1%, 5%. For our example, let’s select as 5% or .05.</p>
<p>The <strong>third step</strong> is to perform the test and obtain the <strong>p-value</strong>.</p>
<blockquote class="blockquote">
<p>p-value =&lt; <span class="math inline">\(\alpha\)</span> : <span class="math inline">\(H_1\)</span> hypothesis</p>
<p>p-value &gt; <span class="math inline">\(\alpha\)</span> : <span class="math inline">\(H_0\)</span> hypothesis</p>
</blockquote>
<p>We will perform the t-test on our dataset in R.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(data<span class="sc">$</span>TestScore <span class="sc">~</span> data<span class="sc">$</span>Class, <span class="at">var.equal =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>We use <code>t.test()</code> function from R. We have specified the test score and class variable. Here, the test score is the dependent variable and class is an independent variable. We have also specified that the variance of groups is not equal. It automatically selects <code>Welsh t-test</code> when we tell that the variance among groups is not the same.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./images/statistical_tests/t-test.png" class="img-fluid figure-img"></p>
<figcaption>Screenshot 2021-03-09 at 12.27.02</figcaption>
</figure>
</div>
<p>In the results, we can see <code>p-value</code>. We will compare it with <span class="math inline">\(\alpha\)</span>. We can see that the p-value is less than .05 (or our selected level of significance). Hence, we say that <strong>null hypothesis is rejected</strong> and the alternative hypothesis can be accepted. From the results, we can also see that group-A mean is higher than group-B. We can say that the average test score from class A is <strong>significanlty</strong> higher than the average test score from class B.</p>
</section>
</section>
<section id="one-sample-t-test" class="level4">
<h4 class="anchored" data-anchor-id="one-sample-t-test">One sample t-test</h4>
<p>This is the most basic scenario for a t-test. In our list of examples, the first example is where we use one-sample t-test. So if you have a single sample and you want to test whether the statistic (e.g., mean, variance, standard deviation) obtained from the sample is population statistic or not.</p>
<p>For this test, we will use <code>women</code> dataset from the R <code>datasets</code> package. This dataset has two attributes- height and weight of American women. We want to see whether the average height of American women is 65 (this is what we got from our sample) or not.</p>
<p>So here we set up the following hypothesis</p>
<blockquote class="blockquote">
<p>H_0 : Average height is same as 65 (hypothesis of no difference)</p>
<p>H_1: Average height is not the same as 65.</p>
</blockquote>
<p>Don’t forget to test the assumptions for the t-test. In this case, we will go for testing the distribution is normal or not. You can plot the histogram or density plot and check for <code>bell shape</code>.</p>
<p>We then set the level of significance as 5% (or .05)</p>
<p>Let’s perform the test now.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load datasets package</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(datasets)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(women<span class="sc">$</span>height,<span class="at">mu=</span><span class="dv">65</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./images/statistical_tests/one-sample.png" class="img-fluid figure-img"></p>
<figcaption>Screenshot 2021-03-09 at 14.03.46</figcaption>
</figure>
</div>
<p>From our results from the t-test, we can see that the p-value is not less than .05 which means we can not reject our null hypothesis.</p>
</section>
<section id="paired-t-test" class="level4">
<h4 class="anchored" data-anchor-id="paired-t-test">Paired t-test</h4>
<p>Let’s think about the third example which we have discussed in the start.</p>
<blockquote class="blockquote">
<p>We collected two samples of test scores of same classroom at the start of the semester and end of the semester. We wanted to test whether the students’ test scores’ were improved significantly or not.</p>
</blockquote>
<p>For this exercise, we have the following dataset of test scores of the same students at the start of the lecture and end of the lecture.</p>
<table class="table">
<thead>
<tr class="header">
<th>test-1</th>
<th>test-2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>175</td>
<td>296</td>
</tr>
<tr class="even">
<td>329</td>
<td>376</td>
</tr>
<tr class="odd">
<td>238</td>
<td>309</td>
</tr>
<tr class="even">
<td>60</td>
<td>222</td>
</tr>
<tr class="odd">
<td>271</td>
<td>150</td>
</tr>
<tr class="even">
<td>291</td>
<td>316</td>
</tr>
<tr class="odd">
<td>364</td>
<td>321</td>
</tr>
<tr class="even">
<td>402</td>
<td>447</td>
</tr>
<tr class="odd">
<td>70</td>
<td>220</td>
</tr>
<tr class="even">
<td>335</td>
<td>375</td>
</tr>
<tr class="odd">
<td>300</td>
<td>310</td>
</tr>
<tr class="even">
<td>245</td>
<td>310</td>
</tr>
<tr class="odd">
<td>186</td>
<td>282</td>
</tr>
<tr class="even">
<td>31</td>
<td>317</td>
</tr>
<tr class="odd">
<td>104</td>
<td>362</td>
</tr>
<tr class="even">
<td>132</td>
<td>338</td>
</tr>
<tr class="odd">
<td>94</td>
<td>263</td>
</tr>
<tr class="even">
<td>38</td>
<td>138</td>
</tr>
<tr class="odd">
<td>62</td>
<td>329</td>
</tr>
<tr class="even">
<td>139</td>
<td>292</td>
</tr>
<tr class="odd">
<td>94</td>
<td>275</td>
</tr>
<tr class="even">
<td>48</td>
<td>150</td>
</tr>
<tr class="odd">
<td>68</td>
<td>319</td>
</tr>
<tr class="even">
<td>138</td>
<td>300</td>
</tr>
</tbody>
</table>
<p>So data were collected from the same students. In this case, we will apply the paired t-test to test whether there is any improvement in students’ test scores after attending the lecture or not.</p>
<p>We first need to test the assumptions (Skipped for it. You can check the assumptions <a href="https://ncss-wpengine.netdna-ssl.com/wp-content/themes/ncss/pdf/Procedures/NCSS/Paired_T-Test.pdf">here</a>)</p>
<p>We will set-up our hypothesis</p>
<blockquote class="blockquote">
<p>H_0 : There is no difference in students’ test performance before and after the lecture (null hypothesis)</p>
<p>H_1 : There’s is a difference in students’ test performance before and after the lecture.</p>
</blockquote>
<p>Then, we would set the level of significance as 5% (.05).</p>
<p>We will perform the test now using the same function but this time we specify the <code>paired</code> parameter as <code>TRUE</code>.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./images/statistical_tests/paired_snapshot.png" class="img-fluid figure-img"></p>
<figcaption>Screenshot 2021-03-09 at 14.25.27</figcaption>
</figure>
</div>
<p>In the results, if we look at the <code>p-value</code> and that is <strong>.00000894</strong>. This value is smaller than <span class="math inline">\(\alpha\)</span> which means we can reject the null hypothesis. We accept the alternative hypothesis.</p>
</section>
<section id="anova" class="level4">
<h4 class="anchored" data-anchor-id="anova">ANOVA</h4>
<p>ANOVA or <strong>AN</strong>alysis <strong>O</strong>f <strong>VA</strong>riance test has its usage in a different scenario and here we are going to talk about the most basic one. We use an independent sample t-test when we have only two groups but when we have more than two groups we employ ANOVA test.</p>
<p>Let’s take an example. We have a diet dataset (you can download it from <a href="https://www.sheffield.ac.uk/polopoly_fs/1.570199!/file/stcp-Rdataset-Diet.csv">here</a>). This dataset has attributes person id, gender, height, diet, weight before taking diet, weight after taking the diet. There were three different diets were given. We want to test whether the diet has any impact on weight loss or not.</p>
<p>So first we compute the weight loss for each participant.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> data <span class="ot">&lt;-</span> <span class="fu">import</span>(<span class="st">'anova_test_dataset_diet.csv'</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">str</span>(data)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="st">'data.frame'</span><span class="sc">:</span>   <span class="dv">78</span> obs. of  <span class="dv">7</span> variables<span class="sc">:</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a> <span class="er">$</span> Person      <span class="sc">:</span> int  <span class="dv">25</span> <span class="dv">26</span> <span class="dv">1</span> <span class="dv">2</span> <span class="dv">3</span> <span class="dv">4</span> <span class="dv">5</span> <span class="dv">6</span> <span class="dv">7</span> <span class="dv">8</span> ...</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> gender      <span class="sc">:</span> int  <span class="cn">NA</span> <span class="cn">NA</span> <span class="dv">0</span> <span class="dv">0</span> <span class="dv">0</span> <span class="dv">0</span> <span class="dv">0</span> <span class="dv">0</span> <span class="dv">0</span> <span class="dv">0</span> ...</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> Age         <span class="sc">:</span> int  <span class="dv">41</span> <span class="dv">32</span> <span class="dv">22</span> <span class="dv">46</span> <span class="dv">55</span> <span class="dv">33</span> <span class="dv">50</span> <span class="dv">50</span> <span class="dv">37</span> <span class="dv">28</span> ...</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> Height      <span class="sc">:</span> int  <span class="dv">171</span> <span class="dv">174</span> <span class="dv">159</span> <span class="dv">192</span> <span class="dv">170</span> <span class="dv">171</span> <span class="dv">170</span> <span class="dv">201</span> <span class="dv">174</span> <span class="dv">176</span> ...</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> pre.weight  <span class="sc">:</span> int  <span class="dv">60</span> <span class="dv">103</span> <span class="dv">58</span> <span class="dv">60</span> <span class="dv">64</span> <span class="dv">64</span> <span class="dv">65</span> <span class="dv">66</span> <span class="dv">67</span> <span class="dv">69</span> ...</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> Diet        <span class="sc">:</span> int  <span class="dv">2</span> <span class="dv">2</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> ...</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> weight6weeks<span class="sc">:</span> num  <span class="dv">60</span> <span class="dv">103</span> <span class="fl">54.2</span> <span class="dv">54</span> <span class="fl">63.3</span> <span class="fl">61.1</span> <span class="fl">62.2</span> <span class="dv">64</span> <span class="dv">65</span> <span class="fl">60.5</span> ...</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>weightLoss <span class="ot">&lt;-</span> data<span class="sc">$</span>pre.weight <span class="sc">-</span> data<span class="sc">$</span>weight6weeks</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Now we will consider two attributes for our ANOVA test: weightLoss and type of diet.</p>
<p>Following are assumptions for the ANOVA test</p>
<ul>
<li>The dependent variable (weightLoss in our example) is normally distributed in each group (diet types in our example).</li>
<li>The variance of the dependent variable is the same for all groups of the independent variable.</li>
<li>Independence data samples.</li>
</ul>
<p>We use <code>aov()</code> function in R to perform the ANOVA test.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./images/statistical_tests/anova_snap.png" class="img-fluid figure-img"></p>
<figcaption>Screenshot 2021-03-09 at 15.00.15</figcaption>
</figure>
</div>
<p>Here, you need to look for <code>Pr(&gt;F)</code> column that is <code>p-value</code> for the ANOVA test. We can see this value is smaller than .05 (5% level of significance) and even also than .01 (1% level of significance). We can say the null hypothesis is rejected. You can refer to this <a href="https://bioinformatics-core-shared-training.github.io/linear-models-r/anova.html">link</a> for a detailed analysis of the same.</p>
</section>
</section>
<section id="when-to-do-which-test" class="level3">
<h3 class="anchored" data-anchor-id="when-to-do-which-test">When to do which test?</h3>
<p>You might be already wondering why we have so many tests and how would I know when to apply which test. To simplify it, you can refer to the following</p>
<blockquote class="blockquote">
<p>You have a single variable (continuous type or numeric in R) that you want to investigate and you are interested in finding some knowledge about the population on that variable.</p>
<p><strong>One sample t-test</strong></p>
</blockquote>
<blockquote class="blockquote">
<p>You have two variables- one continuous and another with categories. The number of categories is two.</p>
<p><strong>Independent Sample t-test</strong></p>
</blockquote>
<blockquote class="blockquote">
<p>You have the same scenario as above but now you have a second variable with more than two categories.</p>
<p><strong>ANOVA</strong></p>
</blockquote>
<blockquote class="blockquote">
<p>You have two variables (both continuous) containing data collected from the same participants.</p>
<p><strong>Paired t-test</strong></p>
</blockquote>


</section>

<a onclick="window.scrollTo(0, 0); return false;" role="button" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>